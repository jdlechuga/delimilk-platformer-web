enum ActionKind {
    RunningLeft,
    RunningRight,
    Idle,
    IdleLeft,
    IdleRight,
    JumpingLeft,
    JumpingRight,
    CrouchLeft,
    CrouchRight,
    Flying,
    Walking,
    Jumping
}
namespace SpriteKind {
    export const Bumper = SpriteKind.create()
    export const Goal = SpriteKind.create()
    export const Coin = SpriteKind.create()
    export const Flier = SpriteKind.create()
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Bumper, function (sprite, otherSprite) {
    if (sprite.vy > 0 && !(sprite.isHittingTile(CollisionDirection.Bottom)) || sprite.y < otherSprite.top) {
        otherSprite.destroy(effects.ashes, 250)
        otherSprite.vy = -50
        sprite.vy = -2 * pixelsToMeters
        info.changeScoreBy(1)
        music.powerUp.play()
    } else {
        info.changeLifeBy(-1)
        sprite.say("Ow!", invincibilityPeriod)
        music.powerDown.play()
    }
    pause(invincibilityPeriod)
})
function initializeAnimations () {
    initializeHeroAnimations()
    initializeCoinAnimation()
    initializeFlierAnimations()
}
function giveIntroduction () {
    game.setDialogFrame(img`
        . e e e e e e e e e e e e e . . 
        e e e e e e e e e e e e e e e . 
        e e e d d d d d d d d d e e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e d d d d d d d d d d d e e . 
        e e e d d d d d d d d d e e e . 
        e e e e e e e e e e e e e e e . 
        . e e e e e e e e e e e e e . . 
        . . . . . . . . . . . . . . . . 
        `)
    game.setDialogCursor(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 8 8 1 1 1 8 8 1 . . . . 
        . . 1 8 8 8 8 1 8 8 8 8 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 8 8 8 8 8 1 . . . . 
        . . . . 1 8 8 8 8 8 1 . . . . . 
        . . . 1 8 8 8 8 8 8 8 1 . . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 1 8 1 8 8 1 . . . . 
        . . . . 1 1 8 8 . 1 1 . . . . . 
        . . . . . 8 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    showInstruction("Muevete con las fechas de 'izquierda' y 'derecha'.")
    showInstruction("Salta con la flecha 'arriba' o el botÃ³n 'A'.")
    showInstruction("Haz un salto doble presionando 2 veces el salto.")
}
controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
    attemptJump()
})
function initializeCoinAnimation () {
    coinAnimation = animation.createAnimation(ActionKind.Idle, 200)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 8 8 1 1 1 8 8 1 . . . . 
        . . 1 8 8 8 8 1 8 8 8 8 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 8 8 8 8 8 1 . . . . 
        . . . . 1 8 8 8 8 8 1 . . . . . 
        . . . 1 8 8 8 8 8 8 8 1 . . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 1 8 1 8 8 1 . . . . 
        . . . . 1 1 8 8 . 1 1 . . . . . 
        . . . . . 8 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 9 8 1 1 1 8 9 1 . . . . 
        . . 1 9 8 8 8 1 8 8 8 9 1 . . . 
        . . 1 9 8 8 8 8 8 8 8 9 1 . . . 
        . . . 1 9 8 9 8 9 8 9 1 . . . . 
        . . . . 1 8 8 9 8 8 1 . . . . . 
        . . . 1 9 8 9 8 9 8 9 1 . . . . 
        . . 1 9 8 8 8 8 8 8 8 9 1 . . . 
        . . 1 9 8 8 8 8 8 8 8 9 1 . . . 
        . . . 1 9 8 1 8 1 8 9 1 . . . . 
        . . . . 1 1 9 8 . 1 1 . . . . . 
        . . . . . 9 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 6 8 1 1 1 8 6 1 . . . . 
        . . 1 6 8 8 8 1 8 8 8 6 1 . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . . 1 6 8 6 8 6 8 6 1 . . . . 
        . . . . 1 8 8 6 8 8 1 . . . . . 
        . . . 1 6 8 6 8 6 8 6 1 . . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . . 1 6 8 1 8 1 8 6 1 . . . . 
        . . . . 1 1 6 8 . 1 1 . . . . . 
        . . . . . 6 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 9 8 1 1 1 8 9 1 . . . . 
        . . 1 9 8 8 8 1 8 8 8 9 1 . . . 
        . . 1 9 8 8 8 8 8 8 8 9 1 . . . 
        . . . 1 9 8 9 8 9 8 9 1 . . . . 
        . . . . 1 8 8 9 8 8 1 . . . . . 
        . . . 1 9 8 9 8 9 8 9 1 . . . . 
        . . 1 9 8 8 8 8 8 8 8 9 1 . . . 
        . . 1 9 8 8 8 8 8 8 8 9 1 . . . 
        . . . 1 9 8 1 8 1 8 9 1 . . . . 
        . . . . 1 1 9 8 . 1 1 . . . . . 
        . . . . . 9 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 6 8 1 1 1 8 6 1 . . . . 
        . . 1 6 8 8 8 1 8 8 8 6 1 . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . . 1 6 8 6 8 6 8 6 1 . . . . 
        . . . . 1 8 8 6 8 8 1 . . . . . 
        . . . 1 6 8 6 8 6 8 6 1 . . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . . 1 6 8 1 8 1 8 6 1 . . . . 
        . . . . 1 1 6 8 . 1 1 . . . . . 
        . . . . . 6 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 6 8 1 1 1 8 6 1 . . . . 
        . . 1 6 8 8 8 1 8 8 8 6 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 6 8 6 8 8 1 . . . . 
        . . . . 1 8 8 8 8 8 1 . . . . . 
        . . . 1 8 8 6 8 6 8 6 1 . . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . 1 6 8 8 8 8 8 8 8 6 1 . . . 
        . . . 1 6 8 1 8 1 8 6 1 . . . . 
        . . . . 1 1 8 8 . 1 1 . . . . . 
        . . . . . 8 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
    coinAnimation.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . 1 1 . . . 1 1 . . . . . 
        . . . 1 8 8 1 1 1 8 8 1 . . . . 
        . . 1 8 8 8 8 1 8 8 8 8 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 8 8 8 8 8 1 . . . . 
        . . . . 1 8 8 8 8 8 1 . . . . . 
        . . . 1 8 8 8 8 8 8 8 1 . . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
        . . . 1 8 8 1 8 1 8 8 1 . . . . 
        . . . . 1 1 8 8 . 1 1 . . . . . 
        . . . . . 8 8 . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `)
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Coin, function (sprite, otherSprite) {
    otherSprite.destroy(effects.trail, 250)
    otherSprite.y += -3
    info.changeScoreBy(3)
    music.baDing.play()
})
function attemptJump () {
    // else if: either fell off a ledge, or double jumping
    if (hero.isHittingTile(CollisionDirection.Bottom)) {
        hero.vy = -4 * pixelsToMeters
    } else if (canDoubleJump) {
        doubleJumpSpeed = -3 * pixelsToMeters
        // Good double jump
        if (hero.vy >= -40) {
            doubleJumpSpeed = -4.5 * pixelsToMeters
            hero.startEffect(effects.trail, 500)
            scene.cameraShake(2, 250)
        }
        hero.vy = doubleJumpSpeed
        canDoubleJump = false
    }
}
function animateIdle () {
    mainIdleLeft = animation.createAnimation(ActionKind.IdleLeft, 100)
    animation.attachAnimation(hero, mainIdleLeft)
    mainIdleLeft.addAnimationFrame(img`
        . . . . . . f . . . . . . 
        . . . . . . f f . . . . . 
        . . . . . 1 f f . 1 c . . 
        . . . 1 1 c 1 d 1 f 3 . . 
        . . . 1 e 1 3 d d . . . . 
        . 3 3 1 f b 1 1 1 . . . . 
        3 3 3 3 3 d 1 1 1 1 . . . 
        3 3 e 3 3 3 b 1 1 1 . . . 
        3 3 3 3 3 3 3 1 d 1 . . . 
        . 3 3 3 3 3 1 1 1 . . . . 
        . . c b f a f b . . . . . 
        . . d c b d d 1 c . . . . 
        . . 1 1 3 1 b b 1 . . . . 
        . 1 1 3 f f 1 1 1 . . . f 
        . 3 1 3 f f 1 1 b 1 . 1 . 
        3 3 3 1 1 b b b 1 1 1 . . 
        3 3 3 3 1 1 1 1 1 1 . . . 
        . 3 3 1 1 . 1 1 1 . . . . 
        . . 3 f f . . f f . . . . 
        . . . f . . . f . . . . . 
        `)
    mainIdleRight = animation.createAnimation(ActionKind.IdleRight, 100)
    animation.attachAnimation(hero, mainIdleRight)
    mainIdleRight.addAnimationFrame(img`
        . . . . . . f . . . . . . 
        . . . . . f f . . . . . . 
        . . c 1 . f f 1 . . . . . 
        . . 3 f 1 d 1 c 1 1 . . . 
        . . . . d d 3 1 e 1 . . . 
        . . . . 1 1 1 b f 1 3 3 . 
        . . . 1 1 1 1 d 3 3 3 3 3 
        . . . 1 1 1 b 3 3 3 e 3 3 
        . . . 1 d 1 3 3 3 3 3 3 3 
        . . . . 1 1 1 3 3 3 3 3 . 
        . . . . . b f a f b c . . 
        . . . . c 1 d d b c d . . 
        . . . . 1 b b 1 3 1 1 . . 
        f . . . 1 1 1 f f 3 1 1 . 
        . 1 . 1 b 1 1 f f 3 1 3 . 
        . . 1 1 1 b b b 1 1 3 3 3 
        . . . 1 1 1 1 1 1 3 3 3 3 
        . . . . 1 1 1 . 1 1 3 3 . 
        . . . . f f . . f f 3 . . 
        . . . . . f . . . f . . . 
        `)
}
function setLevelTileMap (level: number) {
    clearGame()
    if (level == 0) {
        tiles.setTilemap(tilemap`level`)
    } else if (level == 1) {
        tiles.setTilemap(tilemap`level_0`)
    } else if (level == 2) {
        tiles.setTilemap(tilemap`level_1`)
    } else if (level == 3) {
        tiles.setTilemap(tilemap`level_2`)
    } else if (level == 4) {
        tiles.setTilemap(tilemap`level_3`)
    } else if (level == 5) {
        tiles.setTilemap(tilemap`level_4`)
    } else if (level == 6) {
        tiles.setTilemap(tilemap`level_5`)
    } else if (level == 7) {
        scene.setBackgroundImage(img`
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4455555444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4455555444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444555554444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444445555555444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444445555555444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444455555444444444444444444444444444444444444444444444444444444445555555444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444445555555444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444445555555444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444555554444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444455555444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444455555444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444444444455555444444444444444444444444444444444
            4444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444
            4444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444
            4444444444444444444444444444444444444444555555544444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444
            4444444444444444444444444444444444444444455555444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444555555544444444444444444444444444444444
            4444444444444444444444444444444444444444444444444444455555555555444444444444444444444444444444444444444444444444444444444455555444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444455555555555555555444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444444555555555555555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444445555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444555555555555555555555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444444555555555555555555555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444445555555555555545555455555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444455555555555555545555455555555444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444555555555555555545555455555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444555555555555555545555455555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            4444444444444444444444444444444444444444444555555555555555545555455555555544444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555444444444444444444444444444444444445555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555544444444444444444444444444444444445555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555444444444444444444444444444444445555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555544444444444444444444444445555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555554444444444444444444444555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555554444444444444444444445555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555555444444444444444444455555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555555555555444444444444555555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444444444444444
            5555555555555555555544444444444555555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444445555555444
            5555555555555555555554444444445555555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444455555555544
            5555555555555555555555445555555555555555555555555555555555555555555555555554444444444444444444444444444444444444444444444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555544444444444444444444444455555555555444444444444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555545555555554444444444445555555555555554444444444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555544444444555555555555555555544444444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555554444445555555555555555555554444444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444455555555555555555555555444444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544555555555555555555555555544444444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554555555455555555554444444444444444444444444444444455555555544
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554555555455555555554444444444444444444444444444444445555555444
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554555555455555555555444444444444444444444444444444444444444444
            5555555555555555555555555555555555555555555555555555555555555555555555554555554555555555555555555554555555455555555555444444444444444444444444444444444444444444
            5555555555555555555555555555555555555555555555555555555555555555555555554555554555555555555555555555555555555555555555544444444444444444444444444444445555555444
            5555555555555555555555555555555555555555555555555555555555555555555555554555554555555555555555555555555555555555555555544444444444444444444444444444555555555554
            5555555555555555555555555555555555555555555555555555555555555555555555554555554555555555555555555555555555555555555555544444444444444444444444444445555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544555555555554444444444444445555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544444444444455555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444444444455555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544444444455555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554444444455555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444444455555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444444455555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544445555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555544455555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555554555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
            `)
        tiles.setTilemap(tilemap`level_6`)
    }
    initializeLevel(level)
}
function initializeFlierAnimations () {
    flierFlying = animation.createAnimation(ActionKind.Flying, 100)
    flierFlying.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . . . . . 
        . . . . f f f . . . . . f f f . . . . . 
        . . . f 1 1 1 f . . . f 1 1 1 f . . . . 
        . . f 1 b 1 1 1 f . f 1 1 1 b 1 f . . . 
        . f 1 1 1 b 1 1 f . f 1 1 b 1 1 1 f . . 
        . f 1 1 1 b b f f f f f b b 1 1 1 f . . 
        . . f 1 1 1 f c f f f c f 1 1 1 f . . . 
        . . . f 1 1 1 f f f f f 1 1 1 f . . . . 
        . . . . f f f . f f f . f f f . . . . . 
        . . . . . . . f . f . f . . . . . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        `)
    flierFlying.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . . . . . 
        . . . f f f . . . . . . . f f f . . . . 
        . . f 1 1 1 f f . . . f f 1 1 1 f . . . 
        . f 1 1 1 1 1 1 f . f 1 1 1 1 1 1 f . . 
        f 1 1 1 1 1 1 f f f f f 1 1 1 1 1 1 f . 
        f 1 1 1 1 b f c f f f c f b 1 1 1 1 f . 
        . f 1 b b 1 1 f f f f f 1 1 b b 1 f . . 
        . . f b 1 1 f . f f f . f 1 1 b f . . . 
        . . . f f f . f . f . f . f f f . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        `)
    flierFlying.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . . . . . 
        . . . . f f f . . . . . f f f . . . . . 
        . . . f 1 1 1 f . . . f 1 1 1 f . . . . 
        . . f 1 b 1 1 1 f . f 1 1 1 b 1 f . . . 
        . f 1 1 1 b 1 1 f . f 1 1 b 1 1 1 f . . 
        . f 1 1 1 b b f f f f f b b 1 1 1 f . . 
        . . f 1 1 1 f c f f f c f 1 1 1 f . . . 
        . . . f 1 1 1 f f f f f 1 1 1 f . . . . 
        . . . . f f f . f f f . f f f . . . . . 
        . . . . . . . f . f . f . . . . . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        `)
    flierIdle = animation.createAnimation(ActionKind.Idle, 100)
    flierIdle.addAnimationFrame(img`
        . . . . . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . . . . . 
        . . . f f f . . . . . . . f f f . . . . 
        . . f 1 1 1 f f . . . f f 1 1 1 f . . . 
        . f 1 1 1 1 1 1 f . f 1 1 1 1 1 1 f . . 
        f 1 1 1 1 1 1 f f f f f 1 1 1 1 1 1 f . 
        f 1 1 1 1 b f c f f f c f b 1 1 1 1 f . 
        . f 1 b b 1 1 f f f f f 1 1 b b 1 f . . 
        . . f b 1 1 f . f f f . f 1 1 b f . . . 
        . . . f f f . f . f . f . f f f . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        . . . . . . f . . . . . f . . . . . . . 
        `)
}
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    attemptJump()
})
function animateRun () {
    mainRunLeft = animation.createAnimation(ActionKind.RunningLeft, 100)
    animation.attachAnimation(hero, mainRunLeft)
    mainRunLeft.addAnimationFrame(img`
        . . . . . . f . . . . . . 
        . . . . . . f f . . . . . 
        . . . . . 1 f f . 1 c . . 
        . . . 1 1 c 1 d 1 f 3 . . 
        . . . 1 e 1 3 d d . . . . 
        . 3 3 1 f b 1 1 1 . . . . 
        3 3 3 3 3 d 1 1 1 1 . . . 
        3 3 e 3 3 3 b 1 1 1 . . . 
        3 3 3 3 3 3 3 1 d 1 . . . 
        . 3 3 3 3 3 1 1 1 . . . . 
        . . c b f a f b . . . . . 
        . . d c b d d 1 c . . . . 
        . . 1 1 3 1 b b 1 . . . . 
        . 1 1 3 f f 1 1 1 . . . f 
        . 3 1 3 f f 1 1 b 1 . 1 . 
        3 3 3 1 1 b b b 1 1 1 . . 
        3 3 3 3 1 1 1 1 1 1 . . . 
        . 3 3 1 1 . 1 1 1 . . . . 
        . . 3 f f . . f f . . . . 
        . . . f . . . f . . . . . 
        `)
    mainRunLeft.addAnimationFrame(img`
        . . . . . . f . . . . . . 
        . . . . . . f f . . . . . 
        . . . . . 1 f f . . . . . 
        . . . 1 1 c 1 d 1 . . . . 
        . . . 1 e 1 3 d d 1 c . . 
        . 3 3 1 f b 1 1 1 f 3 . . 
        3 3 3 3 3 d 1 1 1 1 . . . 
        3 3 e 3 3 3 b 1 1 1 . . . 
        3 3 3 3 3 3 3 1 d 1 . . . 
        . 3 3 3 3 3 1 1 1 . . . . 
        . . c b f a f b . . . . . 
        . . d c b d d 1 c . . . . 
        . . 1 1 3 1 1 b 1 . . . . 
        . 1 1 3 3 b b 1 1 . . . . 
        . 3 1 3 f f 1 1 1 1 . . . 
        3 3 3 1 f f 1 1 b 1 1 . . 
        3 3 3 3 1 b b b 1 1 . 1 . 
        . 3 3 1 1 1 1 1 1 . . . f 
        . . 3 . f f f f . . . . . 
        . . . . f . f . . . . . . 
        `)
    mainRunRight = animation.createAnimation(ActionKind.RunningRight, 100)
    animation.attachAnimation(hero, mainRunRight)
    mainRunRight.addAnimationFrame(img`
        . . . . . . f . . . . . . 
        . . . . . f f . . . . . . 
        . . . . . f f 1 . . . . . 
        . . . . 1 d 1 c 1 1 . . . 
        . . c 1 d d 3 1 e 1 . . . 
        . . 3 f 1 1 1 b f 1 3 3 . 
        . . . 1 1 1 1 d 3 3 3 3 3 
        . . . 1 1 1 b 3 3 3 e 3 3 
        . . . 1 d 1 3 3 3 3 3 3 3 
        . . . . 1 1 1 3 3 3 3 3 . 
        . . . . . b f a f b c . . 
        . . . . c 1 d d b c d . . 
        . . . . 1 b 1 1 3 1 1 . . 
        . . . . 1 1 b b 3 3 1 1 . 
        . . . 1 1 1 1 f f 3 1 3 . 
        . . 1 1 b 1 1 f f 1 3 3 3 
        . 1 . 1 1 b b b 1 3 3 3 3 
        f . . . 1 1 1 1 1 1 3 3 . 
        . . . . . f f f f . 3 . . 
        . . . . . . f . f . . . . 
        `)
    mainRunRight.addAnimationFrame(img`
        . . . . . . f . . . . . . 
        . . . . . f f . . . . . . 
        . . c 1 . f f 1 . . . . . 
        . . 3 f 1 d 1 c 1 1 . . . 
        . . . . d d 3 1 e 1 . . . 
        . . . . 1 1 1 b f 1 3 3 . 
        . . . 1 1 1 1 d 3 3 3 3 3 
        . . . 1 1 1 b 3 3 3 e 3 3 
        . . . 1 d 1 3 3 3 3 3 3 3 
        . . . . 1 1 1 3 3 3 3 3 . 
        . . . . . b f a f b c . . 
        . . . . c 1 d d b c d . . 
        . . . . 1 b b 1 3 1 1 . . 
        f . . . 1 1 1 f f 3 1 1 . 
        . 1 . 1 b 1 1 f f 3 1 3 . 
        . . 1 1 1 b b b 1 1 3 3 3 
        . . . 1 1 1 1 1 1 3 3 3 3 
        . . . . 1 1 1 . 1 1 3 3 . 
        . . . . f f . . f f 3 . . 
        . . . . . f . . . f . . . 
        `)
}
function animateJumps () {
    // Because there isn't currently an easy way to say "play this animation a single time
    // and stop at the end", this just adds a bunch of the same frame at the end to accomplish
    // the same behavior
    mainJumpLeft = animation.createAnimation(ActionKind.JumpingLeft, 100)
    animation.attachAnimation(hero, mainJumpLeft)
    mainJumpLeft.addAnimationFrame(img`
        . . . f . . . . . f . . . 
        . . f f . . . . . f f . . 
        . . f f d f f f d f f . . 
        1 c c d d b f b d d c c 1 
        f 3 d 1 e d d d e 1 d 3 f 
        . . 1 b f 1 1 1 f b 1 . . 
        . . c d 3 3 3 3 3 d c . . 
        . . b 3 3 e 3 e 3 3 b . . 
        . . 3 3 3 3 3 3 3 3 3 . . 
        . . f 3 3 3 3 3 3 3 f . . 
        . . . f b c c c b f . . . 
        . . 1 b c d 3 d c b 1 . . 
        f 1 3 1 1 1 1 1 1 1 3 1 f 
        f 1 . 3 1 1 1 1 1 3 . 1 f 
        . . 3 d 1 1 3 1 1 d 3 . . 
        . . f 1 1 3 3 3 1 1 f . . 
        . . f 1 3 3 3 3 3 1 f . . 
        . . c b 1 3 3 3 1 b c . . 
        . . f f . 3 . 3 . f f . . 
        . . . f . . . . . f . . . 
        `)
    mainJumpRight = animation.createAnimation(ActionKind.JumpingRight, 100)
    animation.attachAnimation(hero, mainJumpRight)
    mainJumpRight.addAnimationFrame(img`
        . . . f . . . . . f . . . 
        . . f f . . . . . f f . . 
        . . f f d f f f d f f . . 
        1 c c d d b f b d d c c 1 
        f 3 d 1 e d d d e 1 d 3 f 
        . . 1 b f 1 1 1 f b 1 . . 
        . . c d 3 3 3 3 3 d c . . 
        . . b 3 3 e 3 e 3 3 b . . 
        . . 3 3 3 3 3 3 3 3 3 . . 
        . . f 3 3 3 3 3 3 3 f . . 
        . . . f b c c c b f . . . 
        . . 1 b c d 3 d c b 1 . . 
        f 1 3 1 1 1 1 1 1 1 3 1 f 
        f 1 . 3 1 1 1 1 1 3 . 1 f 
        . . 3 d 1 1 3 1 1 d 3 . . 
        . . f 1 1 3 3 3 1 1 f . . 
        . . f 1 3 3 3 3 3 1 f . . 
        . . c b 1 3 3 3 1 b c . . 
        . . f f . 3 . 3 . f f . . 
        . . . f . . . . . f . . . 
        `)
}
// Send a data payload to the hosting iframe of the simulator.
// https://forum.makecode.com/t/extension-to-interact-with-the-web-in-exported-games/4262
function sendMessageToSimulator (action: string, data: string) {
    const json = {
        action: action,
        data: data
    }
const msg = JSON.stringify(json)
const buf = Buffer.fromUTF8(msg);
control.simmessages.send('web', buf)
}
function animateCrouch () {
    mainCrouchLeft = animation.createAnimation(ActionKind.CrouchLeft, 100)
    animation.attachAnimation(hero, mainCrouchLeft)
    mainCrouchLeft.addAnimationFrame(img`
        . . . f . . . . . f . . . 
        . . f f . . . . . f f . . 
        . . f f d f f f d f f . . 
        1 c c d d b f b d d c c 1 
        f 3 d 1 e d d d e 1 d 3 f 
        . . 1 b f 1 1 1 f b 1 . . 
        . . c d 3 3 3 3 3 d c . . 
        . . b 3 3 e 3 e 3 3 b . . 
        . . 3 3 3 3 3 3 3 3 3 . . 
        . . f 3 3 3 3 3 3 3 f . . 
        . . . f b c c c b f . . . 
        . . 1 b c d 3 d c b 1 . . 
        f 1 3 1 1 1 1 1 1 1 3 1 f 
        f 1 . 3 1 1 1 1 1 3 . 1 f 
        . . 3 d 1 1 3 1 1 d 3 . . 
        . . f 1 1 3 3 3 1 1 f . . 
        . . f 1 3 3 3 3 3 1 f . . 
        . . c b 1 3 3 3 1 b c . . 
        . . f f . 3 . 3 . f f . . 
        . . . f . . . . . f . . . 
        `)
    mainCrouchRight = animation.createAnimation(ActionKind.CrouchRight, 100)
    animation.attachAnimation(hero, mainCrouchRight)
    mainCrouchRight.addAnimationFrame(img`
        . . . f . . . . . f . . . 
        . . f f . . . . . f f . . 
        . . f f d f f f d f f . . 
        1 c c d d b f b d d c c 1 
        f 3 d 1 e d d d e 1 d 3 f 
        . . 1 b f 1 1 1 f b 1 . . 
        . . c d 3 3 3 3 3 d c . . 
        . . b 3 3 e 3 e 3 3 b . . 
        . . 3 3 3 3 3 3 3 3 3 . . 
        . . f 3 3 3 3 3 3 3 f . . 
        . . . f b c c c b f . . . 
        . . 1 b c d 3 d c b 1 . . 
        f 1 3 1 1 1 1 1 1 1 3 1 f 
        f 1 . 3 1 1 1 1 1 3 . 1 f 
        . . 3 d 1 1 3 1 1 d 3 . . 
        . . f 1 1 3 3 3 1 1 f . . 
        . . f 1 3 3 3 3 3 1 f . . 
        . . c b 1 3 3 3 1 b c . . 
        . . f f . 3 . 3 . f f . . 
        . . . f . . . . . f . . . 
        `)
}
function clearGame () {
    for (let value of sprites.allOfKind(SpriteKind.Bumper)) {
        value.destroy()
    }
    for (let value2 of sprites.allOfKind(SpriteKind.Coin)) {
        value2.destroy()
    }
    for (let value3 of sprites.allOfKind(SpriteKind.Goal)) {
        value3.destroy()
    }
    for (let value4 of sprites.allOfKind(SpriteKind.Flier)) {
        value4.destroy()
    }
}
scene.onOverlapTile(SpriteKind.Player, assets.tile`tile1`, function (sprite, location) {
    info.changeLifeBy(1)
    currentLevel += 1
    if (hasNextLevel()) {
        game.splash("Â¡Pasas al siguiente nivel!")
        setLevelTileMap(currentLevel)
    } else {
        sendMessageToSimulator("data", "" + info.score())
        sendMessageToSimulator("event", "endGame")
        game.over(true, effects.confetti)
    }
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Flier, function (sprite, otherSprite) {
    info.changeLifeBy(-1)
    sprite.say("Ow!", invincibilityPeriod * 1.5)
    music.powerDown.play()
    pause(invincibilityPeriod * 1.5)
})
function createEnemies () {
    // enemy that moves back and forth
    for (let value5 of tiles.getTilesByType(assets.tile`tile4`)) {
        bumper = sprites.create(img`
            . . . f . . . . . . f . . . 
            . f . f . . . . . . f . f . 
            . f . f . . . . . . f . f . 
            . f . . f . f f . f . . f . 
            . f . . . f b d f . . . f . 
            . . f . f f b b f f . f . . 
            . . . f . f f f f . f . . . 
            . . f . f f b d b f . f . . 
            . f . . f f b d d f . . f . 
            f . . f f f b d d f f . . f 
            f . f . f f b d d f . f . f 
            f . f . f f b b b f . f . f 
            . . f . . f b b f . . f . . 
            . . . . . . f f . . . . . . 
            `, SpriteKind.Bumper)
        tiles.placeOnTile(bumper, value5)
        tiles.setTileAt(value5, assets.tile`tile0`)
        bumper.ay = gravity
        if (Math.percentChance(50)) {
            bumper.vx = Math.randomRange(30, 60)
        } else {
            bumper.vx = Math.randomRange(-60, -30)
        }
    }
    // enemy that flies at player
    for (let value6 of tiles.getTilesByType(assets.tile`tile7`)) {
        flier = sprites.create(img`
            . . . . . . . . . . . . . . . . . . . . 
            . . . . f f f . . . . . f f f . . . . . 
            . . . f 1 1 1 f . . . f 1 1 1 f . . . . 
            . . f 1 b 1 1 1 f . f 1 1 1 b 1 f . . . 
            . f 1 1 1 b 1 1 f . f 1 1 b 1 1 1 f . . 
            . f 1 1 1 b b f f f f f b b 1 1 1 f . . 
            . . f 1 1 1 f c f f f c f 1 1 1 f . . . 
            . . . f 1 1 1 f f f f f 1 1 1 f . . . . 
            . . . . f f f . f f f . f f f . . . . . 
            . . . . . . . f . f . f . . . . . . . . 
            . . . . . . f . . . . . f . . . . . . . 
            . . . . . . f . . . . . f . . . . . . . 
            `, SpriteKind.Flier)
        tiles.placeOnTile(flier, value6)
        tiles.setTileAt(value6, assets.tile`tile0`)
        animation.attachAnimation(flier, flierFlying)
        animation.attachAnimation(flier, flierIdle)
    }
}
controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
    if (!(hero.isHittingTile(CollisionDirection.Bottom))) {
        hero.vy += 80
    }
})
info.onLifeZero(function () {
    sendMessageToSimulator("data", "" + info.score())
    sendMessageToSimulator("event", "endGame")
    game.over(false, effects.dissolve)
})
function showInstruction (text: string) {
    game.showLongText(text, DialogLayout.Bottom)
    music.baDing.play()
    info.changeScoreBy(1)
}
function initializeHeroAnimations () {
    animateRun()
    animateIdle()
    animateCrouch()
    animateJumps()
}
function createPlayer (player2: Sprite) {
    player2.ay = gravity
    scene.cameraFollowSprite(player2)
    controller.moveSprite(player2, 100, 0)
    player2.z = 5
    info.setLife(3)
    info.setScore(0)
}
function initializeLevel (level: number) {
    playerStartLocation = tiles.getTilesByType(assets.tile`tile6`)[0]
    tiles.placeOnTile(hero, playerStartLocation)
    tiles.setTileAt(playerStartLocation, assets.tile`tile0`)
    createEnemies()
    spawnGoals()
}
function hasNextLevel () {
    return currentLevel != levelCount
}
function spawnGoals () {
    for (let value7 of tiles.getTilesByType(assets.tile`tile5`)) {
        coin = sprites.create(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . 1 1 . . . 1 1 . . . . . 
            . . . 1 8 8 1 1 1 8 8 1 . . . . 
            . . 1 8 8 8 8 1 8 8 8 8 1 . . . 
            . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
            . . . 1 8 8 8 8 8 8 8 1 . . . . 
            . . . . 1 8 8 8 8 8 1 . . . . . 
            . . . 1 8 8 8 8 8 8 8 1 . . . . 
            . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
            . . 1 8 8 8 8 8 8 8 8 8 1 . . . 
            . . . 1 8 8 1 8 1 8 8 1 . . . . 
            . . . . 1 1 8 8 . 1 1 . . . . . 
            . . . . . 8 8 . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, SpriteKind.Coin)
        tiles.placeOnTile(coin, value7)
        animation.attachAnimation(coin, coinAnimation)
        animation.setAction(coin, ActionKind.Idle)
        tiles.setTileAt(value7, assets.tile`tile0`)
    }
}
let heroFacingLeft = false
let coin: Sprite = null
let playerStartLocation: tiles.Location = null
let flier: Sprite = null
let bumper: Sprite = null
let mainCrouchRight: animation.Animation = null
let mainCrouchLeft: animation.Animation = null
let mainJumpRight: animation.Animation = null
let mainJumpLeft: animation.Animation = null
let mainRunRight: animation.Animation = null
let mainRunLeft: animation.Animation = null
let flierIdle: animation.Animation = null
let flierFlying: animation.Animation = null
let mainIdleRight: animation.Animation = null
let mainIdleLeft: animation.Animation = null
let doubleJumpSpeed = 0
let canDoubleJump = false
let coinAnimation: animation.Animation = null
let currentLevel = 0
let levelCount = 0
let gravity = 0
let pixelsToMeters = 0
let invincibilityPeriod = 0
let hero: Sprite = null
scene.setBackgroundImage(img`
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ....................................................................................1111........................................................................
    ...................................................................................111111.......................................................................
    ..................................................................................1111111.......................................................................
    ...........................................................................11111111111111.......................................................................
    ..........................................................................111111111111111.......11..............................................................
    ..........................................................................111111111111111.....11111.............................................................
    ..........................................................................111111111111111....1111111............................................................
    ..........................................................................111111111111111....1111111............................................................
    ..........................................................................111111111111111...11111111............................................................
    ...........................................................................11111111111111...11111111111.........................................................
    ...........................................................................11111111111111..1111111111111........................................................
    ............................................................................1111111111111..1111111111111........................................................
    ..............................................................................11111111111.11111111111111........................................................
    ...............................................................................1111111111111111111111111........................................................
    .......................................................................111111...11111111111111111111111.........................................................
    ......................................................................11111111111111111111111111111111..........................................................
    .....................................................................1111111111111111111111111111111............................................................
    .....................................................................1111111111111111111111111..................................................................
    ......................................................................111111111111111111111111..................................................................
    ......................................................................11111111111111111111111111111.............................................................
    .......................................................................11111111111111111111111111111............................................................
    .......................................................................111111111111111111111111111111...........................................................
    .......................................................................111111111111111111111111111111...........................................................
    .......................................................................111111111111.11.11111111111111...........................................................
    .......................................................................11111111111.111.11111111111111...........................................................
    .......................................................................111111111...11..111111111111.............................................................
    .......................................................................11111111...111...1111111111..............................................................
    .........................1.............................................111111....111....111111111...............................................................
    .........11111111111111111.....................................11111.............111.....1111111.........11111..................................................
    ........111111111111111111....................................111111.....................1111111.........111111.................................................
    ........11111111111111111.....................................111111.......................111...........111111.................................................
    ........11111111111111111.....................................111111.....................................111111.................................................
    ........11...111111...........................................111111....................................111111..................................................
    .............111111.........111......11..........111111.......111111.....................111111.........111111..........11111..111.............111111...........
    .............111111.......111111....1111.......111111111......11111.....11111..........111111111........111111........11111111111111........1111111111..........
    .............11111........111111...11111.....111111111111.....11111....1111111.......111111111111.......111111......1111111111111111.......111111111111.........
    ............111111........111111..111111....11111..111111....111111...111111111.....11111111111111......11111......1111111111111111.......11111..11111..........
    ............111111........11111..1111111...11111...111111....111111..1111111111....111111...1111111.....11111......11111....1111111......1111......111..........
    ............111111........11111.1111111...11111.....11111....111111.11111111111....11111.....111111....111111.....11111......111111.....11111......11...........
    ............111111.......111111.1111111...11111....111111....11111.111...111111...111111.....111111....111111....111111......111111....11111....................
    ............11111........1111111111.11...11111.....11111.....11111111....111111..111111......111111....111111....11111......111111.....11111....................
    ...........111111........111111111......111111.....11111....111111111....111111..111111......111111....11111....111111......111111....11111.....................
    ...........111111........11111111.......111111....11111.....11111111.....111111.111111.......111111....11111....111111.....1111111....11111.....................
    ...........111111........1111111........111111.1111111......11111111.....11111..111111.......111111...111111....11111......1111111...111111.....................
    ...........111111........1111111.......11111111111111.......1111111.....111111..111111.......111111...111111...111111.....11111111...111111.....................
    ...........11111........1111111........111111111111.........1111111.....111111..111111.......111111...111111...111111.....11111111...111111.....................
    ..........111111........1111111........11111111............1111111......111111..111111......111111....111111...111111....11111111...1111111.....................
    ..........111111........111111.........111111..............1111111......11111..1111111......111111....11111....111111...111111111...1111111.....................
    ..........111111........111111.........111111..............111111......111111..1111111......11111....111111....111111...111111111...1111111..........11.........
    ..........111111........111111.........111111..............111111......11111...1111111.....111111....111111....111111..111.111111...1111111.........1111........
    ..........11111........111111..........111111.........1....111111.....111111....111111.....11111.....111111....111111.1111.111111...1111111.........1111........
    .........111111........111111..........1111111......1111..1111111.....11111.....111111....111111.....111111....1111111111..111111....1111111.....111.111........
    .........111111........111111..........11111111...11111...111111111..11111......1111111..111111......111111....111111111...111111....11111111.111111............
    .........111111........11111............111111111111111...111111111111111........1111111111111.......111111....111111111...111111....11111111111111.............
    .........111111........11111............1111111111111.....11111111111111..........11111111111........1111111...11111111....1111111....111111111111..............
    .........11111.........11111..............111111111.......11111.1111111............11111111...........11111.....11111.......11111......111111111................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    `)
pause(500)
scene.setBackgroundImage(img`
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888888888888888888888881111111181888888888888888888888888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888888888111188111188811118111111111181111881111811111111188888888888888888888888888888888888888888888888888888888
    8888888888888888888888888888888888888888888888888881111111118111188811111111888888881111181111811111111111111888111888888888888888888888888888888888888888888888
    8888888888888888888888888888888888111111118888888811118881118111188811111111888888881111111111888811118881111888111181111188888888888888888888888888888888888888
    8888888888888888888888888888888881111111111888888811118881118111188811118111111888881111111111888811118881111888111181111111118888888888888888888888888888888888
    8888888888888888888888888888888811118881111888888811111111111111188111188111111888881118811111888811188881111888111111118881111811111118888888888888888888888888
    8888888888888888888881111888888811118881111888888811111111111111181111188111888888881118881111888811188881111888111811118881111811111111188888888888888888888888
    8888888888888888888881111888888881111111111888888811118881111111111111888111111111181118881111888811188881111888111811111111118811188811118888888888888888888888
    8888888888888888888881111888888881111111111888888811118881111811111188888111111111181118881111888811188881111881111811118111118111118811118888888888888888888888
    8888888888888888888881111888888881111888111888888881118881111818888888888888888888888888888888888811188881111111111811118881118111111111118888888888888888888888
    8888888888888888888888111888111881111888111888888888888888888888888888888888888888888888888888888888888888888111118811118811118111188111118888888888888888888888
    8888888888888888888888111111111181111888118888888888888888888888888888888888888888888888888888888888888888888888888888188811118111188111188888888888888888888888
    8888888888888888888888111111111181188888888888888888888888888888881111111888888888888111111888888888888888888888888888888888818111888111188888888888888888888888
    8888888888888888888888111111188888888888888888888811188888888888881111111118888888881111111188888888111111888888888888888888888888888111188888888888888888888888
    8888888888888888888888818888888888888888811188888111118888888888111111111118888888811111111188888811111111188888888888888888888888888888188888888888888888888888
    8888888888888888888888888888888888811111111118881111118888888881111111111118888888111111111188888811111111118888888888811118888888888888888888888888888888888888
    8888888888888888888888888888888888811111111111881111118888888881111118111888888881111111111111888811111111111188888811111118888888888888888888888888888888888888
    8888888888888888888888888888888888111111111111881111111888888881111118188888888881111118811111888111118811111188881111111111118888888881188888888888888888888888
    8888888888888888881111111118888888111111111118811111118888888881111111888888888881111188811111881111188811111188881111111111111888888111111111888888888888888888
    8888888888888881111111111111888888111111111188811111188888888888811111111888888111111888811111881111188111111188811111888111111888888111111111118888888888888888
    8888888888888881111111111111188881111118888888811111188888888888811111111118888111111111811111881111111111118888111118888811111888888111111111118888888888888888
    8888888888888811111111111111188881111118811888811111888888888888881111111118888111111111811111811111111111118888111188888811111188811111111111111888888888888888
    8888888888888811111111111111118881111111111188111111888888888881118881111111881111111111111118811111188111111888111118888811111188811111181111111188888888888888
    8888888888888811111118811111111881111111111188111111888888888811111111111111881111111111111118811111888111111118111111888111111188811118888111111188888888888888
    8888888888888811111118888111111811111111118888811111111888888811111111111111881111118811111118811111888111111188111111111111111188111118888811111188888888888888
    8888888888888881111118888111111811111111118888811111111188686811111111111111861111168611111118611111111111111186111111111111111181111118881111111888888888888888
    6868686868686881111118888111111811111188888888811111111118888811111111111118888111888888111118811111111111111188811111111111111881111111111111111888888888888888
    8888888888888881111118881111111881111111111111811111111118868681111111118888688888686868811186811111111111111168611111111111111881111111111111111888888888888888
    8686868686868681111111111111111881111111111111811111111188888888111111118888888888888888811188881111111111181188811111111111118811111111111111188888888888888888
    8888888888888888111111111111111181111111111118888111111888686868888888888868686868686868888888888888888811188888888111111111188811111111111111888888888888888888
    6868686868686868811111111111118861111111111118868888888886868686868686868686868686868686868686868686868888888686868111111111186811111181111111186868686868686868
    8686868686868686881111111111118686811118888888686868686868686868686868686868686868686868686868686868686868686868686888888188868681111188111111188686868686868686
    6868686868686868681111111111186868688888868686868686868686868686868686868686868686868686666666666666666666666666666666668886666681118666111111118666666666666666
    8686868686868686881111111111118686868686868686868686868686868686868686686868686868686868686868686868686868686868686868686868686868686868681111168686868686868686
    6666666666666666681111111888888666666666666666666666666666666666666666444444446666666666666666666666666666666666644444466666666666666666661111686666666666666666
    86868686868686868611168686868686868686868686868686868686868686868686444eeeeeee44686868686868686868686868686868444eeeee444686868686868686868686868686868686868686
    666666666666666666666666666666666666666666666666666666666664444444644eeeeeeeeee4444444444666666666664444444644eeeeeeeeee4444444448644444444866666666666666666666
    86868686868686868686868686868686868686868686868686868686444eeeeee444eeeeeeeeeeee4eeeeeeee44686868644eeeeeee44eeeeeeeeeeeeeeeeeeee44eeeeeeee448868686868686868686
    666666666666666666666644444444446666666666666666666666644eeeeeeeeeeeeee111111eeeeeeeeeeeee44666644eeeeeeeeeeeeeee11111eeeeeeeeeeeeeeeeeeeeeee4866666666666666666
    6666666666666666666444eeeeeeeeee44466666666666666666664eeeeeeeeeeeeeee11111111eeeeeeeeeeeee466664eeeeeeeeeeeeee11111111eeeeeeeeeeeeeeeeeeeeee4466666666666666666
    6666666666666666444eeeeeeeeeeeeeee446666666666666666644eeeee11111eeee111111111eeee111111eee446644eeee11111eeeee11111111eee111111eeee111111eeee446666666666666666
    6666666666666644eeeeeeeeeeeeeeeeeeee466666666666666664eeee11111111eee111111111eee1111111eeee4664eee11111111eee111111111e111111111e111111111eee444444466666666666
    96969696969644eeeeeeee111111111eeeeee49696964444444444eee111111111eee111111111ee111111111eee4964eee11111111eee111111111e111111111e111111111eeeeeeeee449696969696
    6666666666664eeeeee11111111111111eeee4466444eeeeeeee44eee1111111111ee11111111eee111111111eee4444eee11111111eee11111111ee111111111ee11111111eeeeeeeeee44666666666
    9696969696944eeee11111111111111111eeee4444eeeeeeeeeeeeeeee11111111eee11111111eee111111111eee444eee111111111eeee1111111ee111111111ee11111111eeeee1eeeee4496969696
    666666666664eee11111111111111111111eee44eeeeeeeeeeeeeeeee111111111eeee11111eeeee111111111eee44eeee111111111eeee11111eeee11111111ee111111111eee11111eeee466666666
    969696969694eee11111111111111111111eeeeeeeeee111111eeeeee111111111ee1111111eeeee111111111eee4eeee1111111111ee1111111eeee11111111ee11111111eee1111111eee496969696
    666666666664eee11111111111111111111eeeeeee11111111111eeee11111111ee111111111eee1111111111eeeeeee1111111111ee111111111eee11111111ee11111111ee11111111eee446666666
    969696969694eee111111111ee111111111eeeeee111111111111eeee11111111ee111111111eee11111111111eeeeee1111111111ee111111111ee11111111eee11111111e111111111eee446969696
    696969696944eee11111111eee111111111eeee111111111111111ee111111111ee111111111eee11111111111eeeee11111111111eee11111111ee11111111ee1111111111111111111eee449696969
    999999999944eee11111111eee111111111eee1111111111111111ee11111111eee111111111ee111111111111eeee11111111111eeee11111111ee11111111ee111111111111111111eeee449999999
    969696969644eee11111111eee111111111ee11111111111111111ee11111111eee11111111eee111111111111eee111111111111eee11111111ee111111111ee1111111111111111eeeeee446969696
    99999999994eee111111111eee111111111e11111111ee11111111e111111111ee111111111eee111111111111eee111111111111eee11111111ee11111111eee11111111111111eeeeeee4499999999
    69696969644eee11111111eeee111111111e11111111e11111111ee11111111eee11111111eee1111111111111ee111111111111eeee11111111ee11111111ee11111111111111eeeeee444469696969
    99999999944eee11111111eeee11111111111111111ee11111111ee11111111eee11111111eee1111111111111e1111111111111eeee1111111eee11111111ee1111111111111eeeee44444999999999
    9999999994eee111111111eeee1111111111111111ee11111111ee111111111eee11111111eee111111111111111111111111111eee11111111ee11111111eee111111111111eeeee444449999999999
    9696969694eee11111111eeeee1111111111111111e111111111ee11111111eee11111111eee1111111111111111111111111111eee11111111ee11111111ee11111111111111eee4449999696969696
    9999999944eee11111111eeee11111111111111111111111111eee11111111eee11111111eee1111111e11111111111e1111111eeee11111111ee11111111ee11111111111111eee4499999999999999
    999999994eee111111111eeee1111111111111111111111111eeee11111111eee11111111eee1111111e11111111111e1111111eee11111111eee1111111eee111111111111111eee499999999999999
    999999944eee111111111eeee111111111111111111111111eeee11111111eee11111111eee11111111e1111111111e11111111eee11111111ee11111111eee111111111111111eeee44999999999999
    999999944eee11111111eeee11111111111111111111111eeeeee11111111eee11111111eee1111111ee111111111ee1111111eeee11111111ee11111111ee11111111111111111eeee4499999999999
    99999994eee111111111eeee111111111111111111111eeeeeeee11111111eee11111111eee1111111ee111111111ee1111111eeee11111111ee11111111ee11111111111111111eeeee449999999999
    99999944eee111111111eee1111111111111111111eeeeeeeeee111111111ee111111111ee11111111ee11111111ee11111111eee11111111eee1111111eee11111111e1111111111eeee44999999999
    99999944eee11111111eee11111111e111111111eeeeeee111ee11111111eee11111111eee11111111ee11111111ee11111111eee11111111ee11111111eee11111111ee1111111111eee44999999999
    9999994eee111111111eee1111111ee111111111eeeeee11111e11111111eee11111111eee1111111eee1111111eee11111111eee11111111ee11111111ee111111111ee1111111111eeee4999999999
    9999944eee111111111ee11111111ee111111111eeee1111111e11111111eee11111111ee11111111eeee11111eee111111111eee111111111e111111111e111111111eee111111111eee44999999999
    9999944eee111111111e11111111eee11111111111111111111111111111ee1111111111e11111111eeeee11eeeee111111111eee111111111e111111111e111111111eee111111111eee44999999999
    999994eee111111111111111111eeee1111111111111111111e111111111ee1111111111e11111111eeeeeeeeeeee111111111eee111111111e111111111ee11111111eeee1111111eeee44999999999
    999944eee11111111111111111eeeee111111111111111111ee1111111111ee111111111e11111111eeeeeeeeeeee111111111eee11111111eee1111111eee1111111eeeeee1111eeeee449999999999
    999944eee1111111111111111eeeeeee1111111111111111eeee11111111eee11111111eee1111111eee44eee44eee1111111eeeeee11111eeeeee111eeeeeeee1eeeeeeeeeeeeeeeee4449999999999
    999944eee111111111111111eeee4eeee11111111111111eeeeee111111eeeeee1111eeeeeee11eeeeee4444444eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee44eeeeeeeee44499999999999
    999944eee1111111111111eeeee444eeee11111111111eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee444444444eeeeeeeeeee4eeeeeeeeeeeeeeeeeeee4eeeeeeeee4444eeeeee4444999999999999
    999944eee111111111111eeeee4444eeeeee111111eeeeeee4eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee44499999444eeeeeeee44444eeeeee44444eeeee444444eee44444444444444449999999999999
    999944eeee111eeeeeeeeeeee444444eeeeeeeeeeeeeeeee4444eeeeeeee4444eeeeee44444eee4444449999999444444444444444444444444444444444444444444449944444444999999999999999
    9999444eeeeeeeeeeeeeeee4444994444eeeeeeeeeeeee444444444444444444444444444444444444499999999944444444444994444444449444444449994444444999999944499999999999999999
    99999444eeeeeeeeeeeee44444999944444eeeeeee4444444994444444444494444444449444444449999999999999444444999999999999999999999999999999999999999999999999999999999999
    9999994444eeee44e44444449999999944444444444444499999944444499999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999444444444444444499999999999444444444499999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999944444444444499999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    `)
pause(1000)
scene.setBackgroundImage(img`
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6699999666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6699999666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666999996666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666669999999666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666669999999666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666699999666666666666666666666666666666666666666666666666666666669999999666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666669999999666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666669999999666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666999996666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666699999666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666699999666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666666666699999666666666666666666666666666666666
    6666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666
    6666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666
    6666666666666666666666666666666666666666999999966666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666
    6666666666666666666666666666666666666666699999666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666999999966666666666666666666666666666666
    6666666666666666666666666666666666666666666666666666699999999999666666666666666666666666666666666666666666666666666666666699999666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666699999999999999999666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666666999999999999999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666669999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666999999999999999999999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666666999999999999999999999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666669999999999999969999699999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666699999999999999969999699999999666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666999999999999999969999699999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666999999999999999969999699999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    6666666666666666666666666666666666666666666999999999999999969999699999999966666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999666666666666666666666666666666666669999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999966666666666666666666666666666666669999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999666666666666666666666666666666669999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999966666666666666666666666669999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999996666666666666666666666999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999996666666666666666666669999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999999666666666666666666699999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999999999999666666666666999999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666666666666666
    9999999999999999999966666666666999999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666669999999666
    9999999999999999999996666666669999999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666699999999966
    9999999999999999999999669999999999999999999999999999999999999999999999999996666666666666666666666666666666666666666666666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999966666666666666666666666699999999999666666666666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999969999999996666666666669999999999999996666666666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999966666666999999999999999999966666666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999996666669999999999999999999996666666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999666699999999999999999999999666666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999966999999999999999999999999966666666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996999999699999999996666666666666666666666666666666699999999966
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996999999699999999996666666666666666666666666666666669999999666
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996999999699999999999666666666666666666666666666666666666666666
    9999999999999999999999999999999999999999999999999999999999999999999999996999996999999999999999999996999999699999999999666666666666666666666666666666666666666666
    9999999999999999999999999999999999999999999999999999999999999999999999996999996999999999999999999999999999999999999999966666666666666666666666666666669999999666
    9999999999999999999999999999999999999999999999999999999999999999999999996999996999999999999999999999999999999999999999966666666666666666666666666666999999999996
    9999999999999999999999999999999999999999999999999999999999999999999999996999996999999999999999999999999999999999999999966666666666666666666666666669999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999966999999999996666666666666669999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999966666666666699999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999666666666699999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999966666666699999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996666666699999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999666666699999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999666666699999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999966669999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999966699999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    `)
hero = sprites.create(img`
    . . . f . . . . . f . . . 
    . . f f . f f f . f f . . 
    1 c f f d b f b d f f c 1 
    f 3 c d d d d d d d c 3 f 
    . . d 1 e d d d e 1 d . . 
    . . 1 b f 1 1 1 f b 1 . . 
    . . c d 3 3 3 3 3 d c . . 
    . . b 3 3 e 3 e 3 3 b . . 
    . . 3 3 3 3 3 3 3 3 3 . . 
    . . f 3 3 3 3 3 3 3 f . . 
    . . . f b c c c b f . . . 
    f 1 1 b c d 3 d c b 1 1 f 
    f 1 3 1 1 1 1 1 1 1 3 1 f 
    . . . 3 1 1 1 1 1 3 . . . 
    . . 3 d 1 1 3 1 1 d 3 . . 
    . . f 1 1 3 3 3 1 1 f . . 
    . . f 1 3 3 3 3 3 1 f . . 
    . . c b 1 3 3 3 1 b c . . 
    . . f f . 3 . 3 . f f . . 
    . . . f . . . . . f . . . 
    `, SpriteKind.Player)
// how long to pause between each contact with a
// single enemy
invincibilityPeriod = 600
pixelsToMeters = 30
gravity = 9.81 * pixelsToMeters
initializeAnimations()
createPlayer(hero)
levelCount = 8
currentLevel = 0
setLevelTileMap(currentLevel)
giveIntroduction()
// set up hero animations
game.onUpdate(function () {
    if (hero.vx < 0) {
        heroFacingLeft = true
    } else if (hero.vx > 0) {
        heroFacingLeft = false
    }
    if (hero.isHittingTile(CollisionDirection.Top)) {
        hero.vy = 0
    }
    if (controller.down.isPressed()) {
        if (heroFacingLeft) {
            animation.setAction(hero, ActionKind.CrouchLeft)
        } else {
            animation.setAction(hero, ActionKind.CrouchRight)
        }
    } else if (hero.vy < 20 && !(hero.isHittingTile(CollisionDirection.Bottom))) {
        if (heroFacingLeft) {
            animation.setAction(hero, ActionKind.JumpingLeft)
        } else {
            animation.setAction(hero, ActionKind.JumpingRight)
        }
    } else if (hero.vx < 0) {
        animation.setAction(hero, ActionKind.RunningLeft)
    } else if (hero.vx > 0) {
        animation.setAction(hero, ActionKind.RunningRight)
    } else {
        if (heroFacingLeft) {
            animation.setAction(hero, ActionKind.IdleLeft)
        } else {
            animation.setAction(hero, ActionKind.IdleRight)
        }
    }
})
// Flier movement
game.onUpdate(function () {
    for (let value8 of sprites.allOfKind(SpriteKind.Flier)) {
        if (Math.abs(value8.x - hero.x) < 60) {
            if (value8.x - hero.x < -5) {
                value8.vx = 25
            } else if (value8.x - hero.x > 5) {
                value8.vx = -25
            }
            if (value8.y - hero.y < -5) {
                value8.vy = 25
            } else if (value8.y - hero.y > 5) {
                value8.vy = -25
            }
            animation.setAction(value8, ActionKind.Flying)
        } else {
            value8.vy = -20
            value8.vx = 0
            animation.setAction(value8, ActionKind.Idle)
        }
    }
})
// Reset double jump when standing on wall
game.onUpdate(function () {
    if (hero.isHittingTile(CollisionDirection.Bottom)) {
        canDoubleJump = true
    }
})
// bumper movement
game.onUpdate(function () {
    for (let value9 of sprites.allOfKind(SpriteKind.Bumper)) {
        if (value9.isHittingTile(CollisionDirection.Left)) {
            value9.vx = Math.randomRange(30, 60)
        } else if (value9.isHittingTile(CollisionDirection.Right)) {
            value9.vx = Math.randomRange(-60, -30)
        }
    }
})
